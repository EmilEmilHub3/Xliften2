<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Movie Vault</title>
    <link href="SimpleStyle.css" rel="stylesheet" />
    <script>
        document.addEventListener('DOMContentLoaded', async function () {

            const select = document.getElementById('movielist');

            // Hent liste fra GET /videos
            try {
                const response = await fetch('/videos');
                if (!response.ok) {
                    throw new Error('HTTP ' + response.status);
                }

                const data = await response.json(); // [{id, title}, ...]

                select.innerHTML = '';

                data.forEach(v => {
                    const opt = document.createElement('option');
                    opt.value = v.id;       // ObjectId
                    opt.innerHTML = v.title; // filnavn
                    select.appendChild(opt);
                });
            } catch (err) {
                console.error('Unable to get movies.', err);
                alert('Kunne ikke hente videoer fra API’et.');
            }

            // Når man klikker på knappen
            document.getElementById("btnWatchMovie").onclick = () => {
                const selectList = document.getElementById("movielist");
                const id = selectList.value;
                if (!id) {
                    alert('Vælg en video først.');
                    return;
                }

                const player = document.getElementById("videoPlayer");
                player.src = '/video/' + encodeURIComponent(id);
                player.play().catch(e => console.error(e));
            };
        });
    </script>

</head>
<body>''


    <div class="container">
        <div class="itemSpan2">
            <H1>The video vault</H1>
        </div>
        <div>
            <select id="movielist">
            </select>
        </div>
        <div>
            <button class="button button1" id="btnWatchMovie">Watch movie</button>
        </div>
        <div class="itemSpan2">

            <video id="videoPlayer" width="650" autoplay>
                <source type="video/mp4" />
            </video>
        </div>
    </div>

        <!-- src="http://localhost:5091/api/movie/get"  muted="muted"-->
</body>
</html>
